rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Product images can be read by anyone.
    // Writes (uploads, updates, deletes) are only allowed for authenticated users
    // who are either dev admins or have the 'admin' custom claim.
    match /products/{imageName} {
      allow read: if true;
      allow write: if request.auth != null &&
                      (request.auth.token.admin == true ||
                       request.auth.token.email == 'paulspshubham94@gmail.com' ||
                       request.auth.token.email == 'paul23sourav@gmail.com') &&
                      request.resource.size < 5 * 1024 * 1024 &&
                      request.resource.contentType.matches('image/.*');
    }
  }
}
